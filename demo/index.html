<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script>
      (() => {
        const media = window.matchMedia?.("(prefers-color-scheme: dark)");
        const root = document.documentElement;
        const applyTheme = () => {
          const theme = media && media.matches ? "dark" : "light";
          root.setAttribute("data-bs-theme", theme);
        };
        applyTheme();
        if (media?.addEventListener) {
          media.addEventListener("change", applyTheme);
        } else if (media?.addListener) {
          media.addListener(applyTheme);
        }
      })();
    </script>
    <title>EPG Widget Demo</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="../dist/epg-widget.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/notosansjp.css">
    <style>
      body {
        font-family: "Noto Sans JP", sans-serif;
      }
    </style>
  </head>
  <body class="bg-body text-body">
    <div class="container py-4">
      <h1 class="mb-3">Web番組表（EPG）埋め込みモジュール</h1>
      <p class="text-secondary">
        GR/BS/CSタブの切り替え、日付リンクによるスクロール、前日を含む縦スクロール表示を確認できます。
      </p>
      <div id="epg-root"></div>
    </div>

    <script src="../dist/epg-widget.js"></script>
    <script>
      const baseUrl = window.location.origin;
      EPGWidget.mount("#epg-root", {
        sources: [
          {
            id: "main",
            label: "標準",
            endpoints: {
              servicesUrl: new URL("https://celive.cela.me/static/api/services.json", baseUrl).href,
              channelsUrl: new URL("https://celive.cela.me/static/api/channels.json", baseUrl).href,
              programsUrl: new URL("https://celive.cela.me/eaapi/programs", baseUrl).href,
            },
            channelWidth: 60,
            channelMinWidth: 60,
            multiServiceWidth: 2600,
            multiServiceMinWidth: 2600,
          },
        ],
        tabs: [
          {
            id: "GR-Z",
            label: "地上波(逗子)",
            sourceId: "main",
            channelFilter: (channel) => channel.tuner === "celive-z" && channel.type === "GR",
            mode: "grouped",
          },
          {
            id: "GR-T",
            label: "地上波(多治見)",
            sourceId: "main",
            channelFilter: (channel) => channel.tuner === "celive-t" && channel.type === "GR",
            mode: "grouped",
          },
          { id: "BS", label: "BS", sourceId: "main", channelTypes: ["BS"], mode: "grouped" },
          { id: "CS", label: "CS", sourceId: "main", channelTypes: ["CS"], mode: "service" },
        ],
        initialTab: "GR-T",
        programsFetchMode: "range",
        pxPerMinute: 4,
      });
    </script>
  </body>
</html>
